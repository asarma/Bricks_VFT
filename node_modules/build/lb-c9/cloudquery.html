<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>LogicBlox Console</title>
    <style type="text/css">
        #runBtn:after {
            content: " \25BA" !important; /* override wrong packed mode value */
        }
    </style>
</head>
<body>
    <script src="./logicblox.js"></script>
    <script src="./mode-notebook.js"></script>
    
    <div class="toolbar">
        <span>
            <label for="url">URL</label>
            <input type="text" id="url" style="width:20em"></input>
            <label for="username"></label>
            <input type="text" id="username" required="true" placeholder="Username">
            <label for="password"></label>
            <input type="password" id="password" required="true"  placeholder="Password">
            <button class="btn" id="connectBtn">connect</button>
        </span>
        <span class="align-right">
            <label for="workSpaceName">workspace</label>
            <input type="text" id="workSpaceName"> </input>   
            <button class="btn" id="openBtn">open</button>
        </span>
    </div>
    <div id="main">
        <div id="top"></div>
        <div id="bottom"></div>
        <div id="resizer"></div>
    </div>
    <div id="promptBackground">
        <form id="loginForm" action="login">
            <table>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td rowspan=2>
                        <input class="btn" type="submit" name="doLogin" value="Login">
                    </td>
                </tr>
                
            
            <div>
            </div>
        </form>
    </div>
    
    <script>
        function $(id) {
            return document.getElementById(id);
        }
        
        // Architect Boot Loader
        require(["lib/architect/architect"], function(architect) {
            require("ace/config").set("packaged", true);
            require.plugins.shift();
            require.plugins.push({
                consumes : [],
                provides : ["http", "c9", "vfs"],
                setup    : function(options, imports, register){
                    register(null, {
                        http: { ajax: function(){} },
                        c9: { on: function(){}  },
                        vfs: { vfs: function(){}  }
                    });
                }
            });
            
            var i = require.plugins.indexOf("plugins/c9.fs/vfs");
            require.plugins.splice(i, 1);
            
            require.plugins.every(function(p) {
                if (p.packagePath != "plugins/logicblox.core/logicblox")
                    return true;
                p.enableLogging = false;
                p.bloxWebURL = "https://myapp.logicblox.com";
            });
            
            architect.resolveConfig(require.plugins, function (err, config) {
                if (err) throw err;
                var app = architect.createApp(config, function(err, app) {
                    if (err) throw err;
                    
                    app.on("error", function(name) {
                        console.log("Loaded " + name);
                    });
                    app.on("service", function(name) {
                        console.log("Loaded " + name);
                    });
                    
                    app.getService("language.complete").setEnterCompletion(true);
                    app.getService("log").setOrigin("logicblox-query-tool");
                    app.getService("querytool").app();
                    
                    window.app = app;
                });
                app.on("service", function(name, service) {
                    if (typeof service != "function")
                        service.name = name;
                    console.log("Loaded " + name);
                });
            });
        });
    </script>
</body>
</html>
