<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>LogiQL REPL</title>
    <style>
    </style>
</head>
<body>
    <script src="./logicblox.js"></script>
    <script>
        // Architect Boot Loader
        require(["lib/architect/architect"], function (architect) {
            require("ace/config").set("packaged", true);
            architect.resolveConfig(require.plugins, function (err, config) {
                if (err) throw err;
                config.forEach(function(p) {
                    if (p.packagePath === "plugins/logicblox.core/logicblox") {
                        p.bloxWebURL = "https://lbdemo.c9.io";
                        p.fileServerURL = "https://lbdemo.c9.io";
                        p.connectBloxAdminURL = null;
                        p.lbWorkspace = null;
                    }
                });
                var app = architect.createApp(config, function(err, app) {
                    if (err) throw err;
                    
                    app.on("error", function(name) {
                        console.log("Loaded " + name);
                    });
                    app.on("service", function(name) {
                        console.log("Loaded " + name);
                    });
                    window.c9 = app;
                    
                    var logicblox = app.getService("logicblox");
                    logicblox.setMultiUserMode(true);
                    logicblox.whitelistCommands(logicblox.DEFAULT_MULTIUSER_WHITELIST);
                    app.getService("language.complete").setEnterCompletion(true);
                    
                    app.repl = app.getService("logicblox_repl").createRepl();
                });                
                app.on("service", function(name, service) {
                    if (typeof service != "function")
                        service.name = name;
                    console.log("Loaded " + name);
                });
            });
        });
    </script>
</body>
</html>
