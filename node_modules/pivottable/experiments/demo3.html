<!doctype html>
<html style="overflow:hidden">
<head>
  <meta charset="utf-8">
  <title>Demo 3 - LogicBlox Pivot Table</title>
  <style>
        #grid{
          position : absolute;
          left : 50px;
          top : 50px;
          right : 50px;
          bottom : 50px;
        }
  </style>
</head>
<body>
    <div id="grid"></div>

    <script type="text/javascript">
    var require = {
        paths: {
          pivot: "../lib/pivot"
        }
    };
    </script>
    <script src="require.js"></script>
    <script>
        require(["./json.file", "pivot/pivot", "pivot/mouse/cell_resize_handler"], 
        function(JsonDataProvider, Pivot){
            var div = document.getElementById("grid");
            
            var pivot = new Pivot(div, 90, 24);
            // pivot.setOption("totals", true);
            
            var providerJson = new JsonDataProvider();
            providerJson.loadFromUrl("summary.json", function(){
                providerJson.setQuery(
                  ["city", "product"],
                  ["month", "year", "person"], 
                  {kind: "sum", entity: "value"},
                function(){ 
                      pivot.setDataProvider(providerJson);
                });
            });
            
            providerJson.enableTotals("city", "product", "month", "year", "person");
            
            var hh = require("pivot/mouse/cell_resize_handler").HorizontalHandler;
            new hh(pivot.$mouseHandler);
            
            window.addEventListener("resize", function(){
                pivot.resize();
            })
        });
    </script>
</body>
</html>